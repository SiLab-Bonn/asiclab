Bootstrap: docker
From: centos:7

# Extracted via: `apptainer inspect --deffile /tools/synopsys/container/snps_container/1.6/data/centos7.simg > /tools/asiclab/container_def/sentarus_centos7.def`
# The make changes:

%files

    # run commands on the host that won't work inside the container
    # onhost /usr/bin

    # call "rr record" with recommended options
    # rr-record /usr/bin

    # https://cgdb.github.io/
    cgdb-0.6.8-1.el7.x86_64.rpm /

%post

    # Remove /etc/localtime symlink and replace with a copy.
    # Otherwise, Singularity will overwrite the UTC zoneinfo file.
    cp -p /etc/localtime /etc/localtime.new
    rm /etc/localtime
    mv /etc/localtime.new /etc/localtime

    yum -y update

    # script interpreters
    yum -y install \
	ksh \
	perl \
	perl-core \
	tcsh

    # debugging
    yum -y install \
	strace \
	valgrind \
	gdb

    # https://rr-project.org/
    rpm -i https://github.com/mozilla/rr/releases/download/5.3.0/rr-5.3.0-Linux-x86_64.rpm

    # https://www.softwarecollections.org/en/scls/rhscl/devtoolset-7/
    yum -y install centos-release-scl
    yum -y install devtoolset-7-gdb

    # provide gdb without having to first run "scl enable"
    for file in $(rpm -ql devtoolset-7-gdb | grep /usr/bin/); do \
	wrapper=/$(echo $file | rev | cut -d/ -f-3 | rev); \
	printf '#!/bin/sh\n\nexec %s ${1+"$@"}\n' $file > $wrapper; \
	chmod 755 $wrapper; \
    done

    rpm -i /cgdb-0.6.8-1.el7.x86_64.rpm
    rm /cgdb-0.6.8-1.el7.x86_64.rpm

    # vcs script calls /usr/bin/dc
    yum -y install \
	bc

    # hspice/bin/HSP_Pack2Go script calls /usr/bin/time
    yum -y install \
	time

    # icv/icv_vue calls /usr/bin/xdpyinfo
    yum -y install \
	xorg-x11-utils

    # sentaurus/svisual calls /usr/bin/Xvfb
    yum -y install \
	xorg-x11-server-Xvfb

    # customcompiler/xvfb-runner.sh calls /usr/bin/netstat
    yum -y install \
	net-tools

    # customcompiler/cdesigner 2020.03 calls /usr/bin/unzip
    yum -y install \
	unzip zip

    # pt/ptc_shell calls /usr/bin/firefox
    yum -y install \
	firefox

    # customcompiler/cdesigner calls xterm, xrestop
    # customcompiler/auxx/sae/utils.tcl calls quota
    # customcompiler/auxx/.../cross_probe_utils.tbc calls lsof
    # customcompiler/auxx/.../strace_collector.tcl calls host
    yum -y install \
	xterm xrestop quota lsof bind-utils

    # remote access
    yum -y install \
	openssh-clients \
	telnet \

    # quality of life
    yum -y install \
	less

    yum -y install \
	redhat-lsb-core

    yum -y install \
	file

    yum -y install \
	xorg-x11-apps

    yum -y install \
	tigervnc-server \
	tigervnc

    yum -y install \
	gcc
    yum -y install \
	glibc-devel.i686 libgcc.i686

    yum -y install \
	bzip2 \
	ncompress

    yum -y install \
	ElectricFence \
	GConf2 \
	GConf2.i686 \
	ImageMagick \
	ImageMagick-c++ \
	ORBit2 \
	ORBit2.i686 \
	OpenEXR-libs \
	SDL \
	SDL.i686 \
	alsa-lib \
	alsa-lib.i686 \
	apr \
	apr-util \
	at-spi2-atk \
	at-spi2-core \
	atk \
	atk.i686 \
	atkmm \
	atlas-devel \
	atlas-sse2.i686 \
	avahi-glib \
	avahi-glib.i686 \
	avahi-libs \
	avahi-libs.i686 \
	blas \
	blas-devel \
	blas.i686 \
	boost-date-time \
	boost-devel \
	boost-devel.i686 \
	boost-regex \
	boost-serialization \
	boost-system \
	boost-system.i686 \
	boost-thread \
	bzip2-libs \
	bzip2-libs.i686 \
	cairo \
	cairo-gobject \
	cairo.i686 \
	cairomm \
	cdparanoia-libs \
	cdparanoia-libs.i686 \
	compat-db47 \
	compat-libf2c-34 \
	compat-libf2c-34.i686 \
	compat-libgfortran-41 \
	compat-libstdc++-33 \
	compat-libstdc++-33.i686 \
	compat-libtiff3 \
	compat-libtiff3.i686 \
	compat-libxcb \
	cups-libs \
	cyrus-sasl-lib \
	cyrus-sasl-lib.i686 \
	dbus-glib \
	dbus-glib.i686 \
	dbus-libs \
	dbus-libs.i686 \
	dyninst-devel \
	elfutils-libelf \
	elfutils-libelf.i686 \
	elfutils-libs \
	elfutils-libs.i686 \
	enchant \
	expat \
	expat-devel \
	expat.i686 \
	fftw-libs-double \
	flac-libs \
	flac-libs.i686 \
	fontconfig \
	fontconfig.i686 \
	freeglut \
	freetype \
	freetype.i686 \
	fribidi \
	gd \
	gd.i686 \
	gdk-pixbuf2 \
	gdk-pixbuf2.i686 \
	giflib \
	giflib.i686 \
	glib2 \
	glib2.i686 \
	glibc \
	glibc.i686 \
	glibmm24 \
	gmp \
	gmp.i686 \
	gnome-vfs2 \
	gnome-vfs2.i686 \
	gnutls \
	gperftools-libs \
	gperftools-libs.i686 \
	graphite2 \
	graphite2.i686 \
	graphviz \
	graphviz.i686 \
	gsm \
	gsm.i686 \
	gstreamer \
	gstreamer-plugins-base \
	gstreamer-plugins-base.i686 \
	gstreamer.i686 \
	gstreamer1 \
	gstreamer1-plugins-base \
	gtk2 \
	gtk2.i686 \
	gtk3 \
	gtkmm24 \
	harfbuzz \
	harfbuzz.i686 \
	hunspell \
	hunspell.i686 \
	ilmbase \
	infiniband-diags \
	infinipath-psm \
	jasper-libs \
	jbigkit-libs \
	keyutils-libs \
	keyutils-libs.i686 \
	krb5-libs \
	krb5-libs.i686 \
	lapack \
	lapack-devel \
	lapack.i686 \
	libGLEW \
	libICE \
	libICE.i686 \
	libSM \
	libSM.i686 \
	libX11 \
	libX11.i686 \
	libXScrnSaver \
	libXScrnSaver.i686 \
	libXau \
	libXau.i686 \
	libXaw \
	libXaw.i686 \
	libXcomposite \
	libXcomposite.i686 \
	libXcursor \
	libXcursor.i686 \
	libXdamage \
	libXdamage.i686 \
	libXdmcp \
	libXext \
	libXext.i686 \
	libXfixes \
	libXfixes.i686 \
	libXfont \
	libXft \
	libXft.i686 \
	libXi \
	libXi.i686 \
	libXinerama \
	libXinerama.i686 \
	libXmu \
	libXmu.i686 \
	libXp \
	libXp.i686 \
	libXpm \
	libXpm.i686 \
	libXrandr \
	libXrandr.i686 \
	libXrender \
	libXrender.i686 \
	libXt \
	libXt.i686 \
	libXtst \
	libXtst.i686 \
	libXv \
	libXv.i686 \
	libXxf86dga \
	libXxf86vm \
	libXxf86vm.i686 \
	libacl.i686 \
	libaio \
	libaio.i686 \
	libart_lgpl \
	libart_lgpl.i686 \
	libasyncns \
	libasyncns.i686 \
	libatomic \
	libattr \
	libattr.i686 \
	libblkid \
	libblkid.i686 \
	libcap \
	libcap.i686 \
	libcom_err \
	libcom_err.i686 \
	libcroco \
	libcroco.i686 \
	libcryptui-devel \
	libdb \
	libdrm \
	libdrm.i686 \
	libdv \
	libdwarf-devel \
	libdwarf-devel.i686 \
	libedit \
	libedit.i686 \
	libepoxy \
	libexif \
	libfabric \
	libffi \
	libffi.i686 \
	libfontenc \
	libgcc \
	libgcc.i686 \
	libgcrypt \
	libgcrypt.i686 \
	libgfortran \
	libgfortran.i686 \
	libgfortran4 \
	libgomp \
	libgomp.i686 \
	libgpg-error \
	libgpg-error.i686 \
	libgsf \
	libibumad \
	libibverbs \
	libicu \
	libicu.i686 \
	libjpeg-turbo \
	libjpeg-turbo.i686 \
	libldb \
	libldb.i686 \
	libmng \
	libmng.i686 \
	libmount \
	libmount.i686 \
	libmpc \
	libnet-devel \
	libnl3 \
	libogg \
	libogg.i686 \
	libpcap \
	libpcap.i686 \
	libpciaccess \
	libpipeline-devel \
	libpng \
	libpng.i686 \
	libpng12 \
	libpng12.i686 \
	libpsm2 \
	libquadmath \
	libquadmath.i686 \
	librdmacm \
	librsvg2 \
	librsvg2.i686 \
	libsecret \
	libselinux \
	libselinux.i686 \
	libsepol.i686 \
	libsigc++20 \
	libsmbclient \
	libsmbclient.i686 \
	libsndfile \
	libsndfile.i686 \
	libsoup \
	libsss_nss_idmap \
	libstdc++.i686 \
	libtalloc \
	libtalloc.i686 \
	libtasn1 \
	libtdb \
	libtdb.i686 \
	libtevent \
	libtevent.i686 \
	libthai \
	libthai.i686 \
	libtiff \
	libtirpc \
	libtool-ltdl \
	libtool-ltdl.i686 \
	libunwind \
	libusb \
	libusb.i686 \
	libusbx \
	libusbx.i686 \
	libuuid \
	libuuid-devel \
	libuuid.i686 \
	libv4l \
	libvorbis \
	libvorbis.i686 \
	libvpx \
	libvpx.i686 \
	libwayland-client \
	libwayland-client.i686 \
	libwayland-cursor \
	libwayland-server \
	libwayland-server.i686 \
	libwbclient.i686 \
	libwmf-lite \
	libxcb \
	libxcb.i686 \
	libxkbcommon \
	libxkbcommon-x11 \
	libxml2 \
	libxml2-devel \
	libxml2-devel.i686 \
	libxml2.i686 \
	libxshmfence \
	libxshmfence.i686 \
	libxslt \
	libxslt-devel \
	libxslt-devel.i686 \
	libxslt.i686 \
	libyaml \
	log4cxx \
	log4cxx-devel \
	lpsolve \
	lz4 \
	lz4.i686 \
	lzo \
	mesa-libEGL \
	mesa-libEGL.i686 \
	mesa-libGL \
	mesa-libGL.i686 \
	mesa-libGLU \
	mesa-libGLU.i686 \
	mesa-libgbm \
	mesa-libgbm.i686 \
	mesa-libglapi \
	mesa-libglapi.i686 \
	mesa-libwayland-egl \
	motif \
	motif.i686 \
	mpfr \
	mpfr.i686 \
	mtdev \
	ncurses-libs.i686 \
	nettle \
	nspr \
	nspr.i686 \
	nss \
	nss-softokn-freebl \
	nss-softokn-freebl.i686 \
	nss-util \
	nss-util.i686 \
	nss.i686 \
	numactl-libs \
	numactl-libs.i686 \
	opencv \
	opencv-core \
	openldap \
	openldap.i686 \
	opensm-libs \
	openssl-libs \
	openssl-libs.i686 \
	openssl098e \
	openssl098e.i686 \
	orc \
	orc.i686 \
	p11-kit \
	pango \
	pango.i686 \
	pangomm \
	pcre \
	pcre.i686 \
	pcre2-utf16 \
	perl-libs \
	phonon \
	pixman \
	pixman.i686 \
	postgresql-libs \
	protobuf \
	pulseaudio-libs \
	pulseaudio-libs-glib2 \
	pulseaudio-libs.i686 \
	python-libs.i686 \
	qt \
	qt-x11 \
	qt-x11.i686 \
	qt.i686 \
	qt3 \
	qt3.i686 \
	qt5-qt3d \
	qt5-qtbase \
	qt5-qtbase-gui \
	qt5-qtconnectivity \
	qt5-qtdeclarative \
	qt5-qtlocation \
	qt5-qtmultimedia \
	qt5-qtquickcontrols2 \
	qt5-qtscript \
	qt5-qtsensors \
	qt5-qtserialbus \
	qt5-qtserialport \
	qt5-qtsvg \
	qt5-qttools-libs-designer \
	qt5-qttools-libs-designercomponents \
	qt5-qttools-libs-help \
	qt5-qtwebchannel \
	qt5-qtwebsockets \
	qt5-qtx11extras \
	qt5-qtxmlpatterns \
	readline.i686 \
	samba-client-libs \
	samba-client-libs.i686 \
	samba-common-libs \
	snappy \
	sqlite-devel \
	sqlite-devel.i686 \
	sqlite.i686 \
	sssd-libwbclient \
	startup-notification \
	startup-notification.i686 \
	suitesparse-devel.i686 \
	suitesparse.i686 \
	systemd-libs \
	systemd-libs.i686 \
	tbb \
	tbb-devel \
	tbb-devel.i686 \
	tbb.i686 \
	tcl \
	tcl.i686 \
	tcp_wrappers-libs \
	tcp_wrappers-libs.i686 \
	tk \
	tk.i686 \
	unixODBC \
	unixODBC.i686 \
	xcb-util \
	xcb-util-image \
	xcb-util-keysyms \
	xcb-util-renderutil \
	xcb-util-wm \
	xcb-util.i686 \
	xerces-c \
	xerces-c.i686 \
	xmlrpc-c \
	xmlrpc-c-c++ \
	xmlrpc-c-client \
	xmlsec1 \
	xmlsec1-openssl \
	xulrunner \
	xulrunner.i686 \
	xz-compat-libs \
	xz-libs \
	xz-libs.i686 \
	zlib \
	zlib-devel \
	zlib-devel.i686 \
	zlib.i686

    yum clean all
